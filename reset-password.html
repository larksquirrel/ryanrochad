<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Reset Password - Ryan Rochad</title>

<style type="text/css">
    、
body {
  font-family: Arial, sans-serif;
  margin: 0;
  padding: 0;
  background-color: #f4f4f4;
}

.container {
  display: flex;
  justify-content: space-between;
  align-items: center;
  min-height: 100vh;
  padding: 0 50px;
}

.left-section {
  background-color: white;
  padding: 30px;
  border-radius: 5px;
  box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
  width: 400px;
}

.logo img {
  width: 150px;
}

h2 {
  text-align: center;
  color: #6c5ce7;
  margin-top: 10px;
  margin-bottom: 10px;
}

p.desc {
  text-align: center;
  color: #555;
  margin-bottom: 20px;
}

input {
  width: 100%;
  padding: 10px;
  margin-bottom: 15px;
  border: 1px solid #ccc;
  border-radius: 3px;
  box-sizing: border-box;
}

button {
  width: 100%;
  padding: 10px;
  background-color: #6c5ce7;
  color: white;
  border: none;
  border-radius: 3px;
  cursor: pointer;
}

button:hover {
  background-color: #5b4ad2;
}

.message {
  display: none;
  margin-top: 15px;
  padding: 10px;
  border-radius: 3px;
}

.success {
  background-color: #d4edda;
  color: #155724;
  border: 1px solid #c3e6cb;
}

.error {
  background-color: #f8d7da;
  color: #721c24;
  border: 1px solid #f5c6cb;
}

.right-section {
  flex: 1;
  text-align: center;
}

.right-section img {
  max-width: 100%;
  height: auto;
}
</style>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>

<body>
<div class="container">

  <!-- 左侧重置密码界面 -->
  <div class="left-section">
    <div class="logo">
      <img src="images/37eef08795715baa9746a6829c38d89.png" alt=""/>
    </div>

    <h2>Reset Your Password</h2>
    <p class="desc">Please enter your new password below.</p>

    <input id="new-password" type="password" placeholder="New Password">
    <input id="confirm-password" type="password" placeholder="Confirm Password">

    <button id="reset-button">Reset Password</button>

    <div id="msg" class="message"></div>
  </div>

  <!-- 右侧图片区域 -->
  <div class="right-section">
    <img src="images/cc54910e440a2e5c3bc6fcc9b17674a.jpg" alt="">
  </div>

</div>

<script>
const { createClient } = supabase;
const client = createClient(
  "https://nixlipqiyezzfvwqtdzj.supabase.co",
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpczMiOiJzdXBhYmFzZSIsInJlZiI6Im5peGxpcHFpeWV6emZ2d3F0ZHpqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIwMTIxODEsImV4cCI6MjA3NzU4ODE4MX0.rZvDmHfMkF5gZM2VWSQuS35LfWL2naJqScVY1Z8g0B4"
);

const msgBox = document.getElementById("msg");

function showMessage(text, type) {
  msgBox.textContent = text;
  msgBox.className = "message " + type;
  msgBox.style.display = "block";
}

document.getElementById("reset-button").addEventListener("click", async () => {
  const newPassword = document.getElementById("new-password").value.trim();
  const confirmPassword = document.getElementById("confirm-password").value.trim();

  if (!newPassword || !confirmPassword) {
    showMessage("Please fill in both fields.", "error");
    return;
  }

  if (newPassword !== confirmPassword) {
    showMessage("Passwords do not match.", "error");
    return;
  }

  const { data, error } = await client.auth.updateUser({
    password: newPassword
  });

  if (error) {
    showMessage("Error: " + error.message, "error");
  } else {
    showMessage("Password reset successfully! Redirecting...", "success");
    setTimeout(() => {
      window.location.href = "index.html";
    }, 2000);
  }
});
</script>

</body>
</html>
